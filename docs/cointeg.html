<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Introduction to cointegration | Introduction to Time Series</title>
<meta name="author" content="Jean-Paul Renne">
<meta name="description" content="6.1 Intuition Many statistical procedures are well-defined only when the processes of interest are stationary. As a result, especially when one wants to investigate the joint dynamics of different...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 6 Introduction to cointegration | Introduction to Time Series">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Intuition Many statistical procedures are well-defined only when the processes of interest are stationary. As a result, especially when one wants to investigate the joint dynamics of different...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Introduction to cointegration | Introduction to Time Series">
<meta name="twitter:description" content="6.1 Intuition Many statistical procedures are well-defined only when the processes of interest are stationary. As a result, especially when one wants to investigate the joint dynamics of different...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="my-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Time Series</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction to Time Series</a></li>
<li><a class="" href="Intro.html"><span class="header-section-number">1</span> Basics</a></li>
<li><a class="" href="Univariate.html"><span class="header-section-number">2</span> Univariate processes</a></li>
<li><a class="" href="VAR.html"><span class="header-section-number">3</span> Multivariate models</a></li>
<li><a class="" href="forecasting.html"><span class="header-section-number">4</span> Forecasting</a></li>
<li><a class="" href="NonStat.html"><span class="header-section-number">5</span> Non-stationary processes</a></li>
<li><a class="active" href="cointeg.html"><span class="header-section-number">6</span> Introduction to cointegration</a></li>
<li><a class="" href="ARCHGARCH.html"><span class="header-section-number">7</span> ARCH and GARCH models</a></li>
<li><a class="" href="append.html"><span class="header-section-number">8</span> Appendix</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cointeg" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Introduction to cointegration<a class="anchor" aria-label="anchor" href="#cointeg"><i class="fas fa-link"></i></a>
</h1>
<div id="intuition" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Intuition<a class="anchor" aria-label="anchor" href="#intuition"><i class="fas fa-link"></i></a>
</h2>
<p>Many statistical procedures are well-defined only when the processes of interest are stationary. As a result, especially when one wants to investigate the joint dynamics of different variables, one often begins by making the data stationary (by, e.g., taking first differences or removing deterministic trends). However, doing so may remove information from the data. Heuristically, removing trends amounts to filtering out the long-run variations of the series. However, it may be the case that the different variables interact in the short run <em>and</em> in the long run.</p>
<p>For instance, the left plot of Figure <a href="cointeg.html#fig:CointegEx">6.1</a> suggests that the trends of <span class="math inline">\(x_t\)</span> and <span class="math inline">\(y_t\)</span> are positively correlated. However, the right plot shows that, for low values of <span class="math inline">\(h\)</span>, the correlation between <span class="math inline">\(x_t - x_{t-h}\)</span> and <span class="math inline">\(y_t - y_{t-h}\)</span> is negative. This is notably the case for <span class="math inline">\(h=1\)</span>, which means that the first differences of the two variables (i.e., <span class="math inline">\(\Delta x_t\)</span> and <span class="math inline">\(\Delta y_t\)</span>) are negatively correlated. Hence, focusing on the first differences would lead the researcher to think that the relationship between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(y_t\)</span> is a negative one (while it is only the case when one focuses on the high-frequency comovements between the two variables).</p>
<div class="figure" style="text-align: left-aligned">
<span style="display:block;" id="fig:CointegEx"></span>
<img src="TimeSeries_files/figure-html/CointegEx-1.png" alt="Situation where the conditional and uncondional correlation between $x_t$ and $y_t$ do not have the same sign." width="95%"><p class="caption">
Figure 6.1: Situation where the conditional and uncondional correlation between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(y_t\)</span> do not have the same sign.
</p>
</div>
<div class="definition">
<p><span id="def:Id" class="definition"><strong>Definition 6.1  (Integrated variables) </strong></span>A univariate process <span class="math inline">\(\{y_t\}\)</span> is said to be <span class="math inline">\(I(d)\)</span> if its <span class="math inline">\(d^{th}\)</span> difference is stationary (but not its <span class="math inline">\((d-1)^{th}\)</span> difference).</p>
</div>
<p>For instance:</p>
<ul>
<li>If <span class="math inline">\(y_t\)</span> is not stationary but <span class="math inline">\(\Delta y_t = y_t - y_{t-1}\)</span> is, then <span class="math inline">\(y_t\)</span> is <span class="math inline">\(I(1)\)</span>.</li>
<li>If <span class="math inline">\(\Delta y_t\)</span> is not stationary but <span class="math inline">\(\Delta^2 y_t=\Delta(\Delta y_t)\)</span> is, then <span class="math inline">\(y_t\)</span> is <span class="math inline">\(I(2)\)</span>.</li>
<li>If <span class="math inline">\(y_t\)</span> is stationary then <span class="math inline">\(y_t\)</span> is <span class="math inline">\(I(0)\)</span>.</li>
</ul>
</div>
<div id="the-bivariate-case" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> The bivariate case<a class="anchor" aria-label="anchor" href="#the-bivariate-case"><i class="fas fa-link"></i></a>
</h2>
<p>If we regress an <span class="math inline">\(I(1)\)</span> variable <span class="math inline">\(y_t\)</span> on another independent <span class="math inline">\(I(1)\)</span> variable <span class="math inline">\(x_t\)</span>, the usual (OLS-based) t-tests on regression coefficients often (misleadingly) show statistically significant coefficients (we then speak of spurious regressions, see Section <a href="NonStat.html#NonStat">5</a>). A solution is to regress <span class="math inline">\(\Delta y_t\)</span> (that is <span class="math inline">\(I(0)\)</span>) on <span class="math inline">\(\Delta x_t\)</span> and then inference will be correct. However, as stated above, the economic interpretation of the regression then changes, as doing so amounts to focusing on the high-frequency movements of the variables.</p>
<p>Let us now consider the case where <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span> are still <span class="math inline">\(I(1)\)</span>, but where they satisfy:
<span class="math display" id="eq:yxI1">\[\begin{equation}
y_t = \beta x_t + \varepsilon_t,\tag{6.1}
\end{equation}\]</span>
with <span class="math inline">\(\varepsilon_t \sim I(0)\)</span>. That is, there is a linear combination of the two <span class="math inline">\(I(1)\)</span> variables that is <span class="math inline">\(I(0)\)</span>.</p>
<p>In that case, the convergence of <span class="math inline">\(b\)</span>, the OLS estimate of <span class="math inline">\(\beta\)</span>, is fast. Indeed, the convergence rate is in <span class="math inline">\(1/T\)</span> (versus <span class="math inline">\(1/\sqrt{T}\)</span> in the purely stationary case). This stems from the properties of non-statinary processes that are stated in Prop. <a href="cointeg.html#prp:I1process">6.1</a>. We have:
<span class="math display">\[
b_T = \frac{\sum_t x_t y_t}{\sum_t x_t^2} = \frac{\sum_t x_t (\beta x_t + \varepsilon_t)}{\sum_t x_t^2}
= \beta + \frac{\sum_t x_t \varepsilon_t}{\sum_t x_t^2}.
\]</span>
In particular, if <span class="math inline">\(\varepsilon_t\)</span> was a white noise, using properties (ii) and (iv) of Prop. <a href="cointeg.html#prp:I1process">6.1</a>, we would get:
<span class="math display" id="eq:bTsuperconv">\[\begin{equation}
b_T \approx \beta + \frac{1}{T}\frac{\int_{0}^{1}x_{\infty}(r)dW^{\varepsilon}_r}{\int_{0}^{1}x^2_{\infty}(r)dr}.\tag{6.2}
\end{equation}\]</span>
where the random variables <span class="math inline">\(x^2_{\infty}\)</span> and <span class="math inline">\(W^{\varepsilon}_r\)</span> are defined in Prop. <a href="cointeg.html#prp:I1process">6.1</a>.</p>
<div class="proposition">
<p><span id="prp:I1process" class="proposition"><strong>Proposition 6.1  (Properties of an I(1) process) </strong></span>If <span class="math inline">\(\{y_t\}\)</span> is <span class="math inline">\(I(1)\)</span> and such that <span class="math inline">\(y_t - y_{t-1} = H(L)\varepsilon_t\)</span> where <span class="math inline">\(H(L)\varepsilon_t\)</span> is <span class="math inline">\(I(0)\)</span>, then:</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(\dfrac{1}{\sqrt{T}}\bar{y}_T \overset{d}{\rightarrow} \int_{0}^{1}y_{\infty}(r)dr\)</span>,</li>
<li>
<span class="math inline">\(\dfrac{1}{T^2}\sum_{t=1}^T y_t^2 \overset{d}{\rightarrow} \int_{0}^{1}y^2_{\infty}(r)dr\)</span>,</li>
<li>
<span class="math inline">\(\dfrac{1}{T}\sum_{t=1}^T y_t(y_t-y_{t-1}) \overset{d}{\rightarrow} \dfrac{1}{2}y^2_{\infty}(1) + \dfrac{1}{2}\mathbb{V}ar(y_t - y_{t-1})\)</span>,</li>
<li>
<span class="math inline">\(\dfrac{1}{T}\sum_{t=1}^T y_t \eta_t \overset{d}{\rightarrow} \sigma_\eta \int_{0}^{1}y_{\infty}(r)dW_r^{\eta}\)</span> where <span class="math inline">\(\eta_t\)</span> is a white noise of variance <span class="math inline">\(\sigma_\eta^2\)</span>,</li>
</ol>
<p>where <span class="math inline">\(y_{\infty}(r)\)</span> is of the form <span class="math inline">\(\omega W_r\)</span> (<span class="math inline">\(W_r\)</span> being a Brownian motion (see <a href="https://www.dropbox.com/s/w4qc1c32pzkxngv/Simul_Brownian.pdf?dl=0">extra material</a>), with <span class="math inline">\(\omega = \sum_{k=-\infty}^{\infty} \gamma_k\)</span>, the <span class="math inline">\(\gamma_k\)</span>s being the autocovariances of <span class="math inline">\(H(L)\varepsilon_t\)</span>, and where <span class="math inline">\(\eta_{\infty}(r)\)</span> is of the form <span class="math inline">\(\sigma_\eta W^{\eta}_r\)</span> (<span class="math inline">\(W^{\eta}_r\)</span> Brownian motion “associated” to <span class="math inline">\(\eta_t\)</span>).</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-19" class="proof"><em>Proof</em>. </span>(of 1)
We have:
<span class="math display">\[
\dfrac{1}{\sqrt{T}}\bar{y}_T = \frac{1}{T}\sum_{t=1}^{T}\frac{y_{t}}{\sqrt{T}} =  \frac{1}{T}\sum_{t=1}^{T}\tilde{y}_T(t/T),
\]</span>
where <span class="math inline">\(\tilde{y}_T(r)=(1/\sqrt{T})y_{[rT]}\)</span>. Now <span class="math inline">\(\tilde{y}_T(r) = r \sqrt{T} \left(\frac{1}{Tr}\sum_{t=1}^{[Tr]} H(L)\varepsilon_t\right)\)</span>. By Eq. <a href="Intro.html#eq:TCL4ts">(1.4)</a> in Theorem <a href="Intro.html#thm:CLTcovstat">1.1</a>, we have <span class="math inline">\(\sqrt{r}\sqrt{Tr} \left(\frac{1}{Tr}\sum_{t=1}^{[Tr]} H(L)\varepsilon_t\right) \rightarrow \omega W_r\)</span>. Therefore, for large <span class="math inline">\(T\)</span>, <span class="math inline">\(\frac{1}{T}\sum_{t=1}^{T}\tilde{y}_T(t/T)\)</span> approximates <span class="math inline">\(\frac{1}{T}\sum_{t=1}^{T} \omega W_{t/T}\)</span>, which is a Riemann sum that converges to <span class="math inline">\(\int_{0}^{1}y_{\infty}(r)dr\)</span>.</p>
</div>
</div>
<div id="multivariate-case-and-vecm" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Multivariate case and VECM<a class="anchor" aria-label="anchor" href="#multivariate-case-and-vecm"><i class="fas fa-link"></i></a>
</h2>
<p>In the following, we consider an <span class="math inline">\(n\)</span>-dimensional vector <span class="math inline">\(y_t\)</span>. Moreover, <span class="math inline">\(\varepsilon_t\)</span> is an <span class="math inline">\(n\)</span>-dimensional white noise process. The notion of integration (Def. <a href="cointeg.html#def:Id">6.1</a>) can also be defined in the multivariate case:</p>
<div class="definition">
<p><span id="def:Idmultivar" class="definition"><strong>Definition 6.2  (Order of integration (multivariate case)) </strong></span><span class="math inline">\(\{y_t\}\)</span> is <span class="math inline">\(I(d)\)</span> if
<span class="math display" id="eq:I1">\[\begin{equation}
(1-L)^dy_t = \mu + H(L)\varepsilon_t,\tag{6.3}
\end{equation}\]</span>
where <span class="math inline">\(H(L)\varepsilon_t\)</span> is a stationary process (but <span class="math inline">\((1-L)^{d-1}y_t\)</span> is not).</p>
</div>
<div class="definition">
<p><span id="def:cointegration" class="definition"><strong>Definition 6.3  (Cointegration) </strong></span>If <span class="math inline">\(y_t\)</span> is integrated of order <span class="math inline">\(d\)</span>, then its components are said to be cointegrated if there exists a linear combination of the components of <span class="math inline">\(y_t\)</span> that is integrated of an order equal to, or lower than, <span class="math inline">\(d-1\)</span>.</p>
</div>
<p>For instance, Eq. <a href="cointeg.html#eq:yxI1">(6.1)</a> implies that <span class="math inline">\([1,-\beta]'\)</span> is a <strong>cointegrating vector</strong> and that <span class="math inline">\([x_t,y_t]'\)</span> is cointegrated.</p>
<p>Consider an <span class="math inline">\(I(1)\)</span> process, <span class="math inline">\(y_t\)</span>, that is such that the Wold representation of <span class="math inline">\(\Delta y_t\)</span> is Eq. <a href="cointeg.html#eq:I1">(6.3)</a>. We have:
<span class="math display">\[
y_t = \mu + H(L)\varepsilon_t + y_{t-1} = t \mu + H(L)(\varepsilon_t + \varepsilon_{t-1} + \dots + \varepsilon_1) + y_0.
\]</span></p>
<p>It can be shown that:
<span class="math display">\[
y_t = t \mu + H(1)(\varepsilon_t + \varepsilon_{t-1} + \dots + \varepsilon_1) + \xi_t,
\]</span>
where <span class="math inline">\(\xi_t\)</span> is a stationary process.</p>
<p>Assume that <span class="math inline">\(y_t\)</span> possesses a cointegrating vector <span class="math inline">\(\pi\)</span> such that <span class="math inline">\(\pi' y_t\)</span> is a (univariate) stationary process.</p>
<p>Necessarily, we must have <span class="math inline">\(\pi' \mu = 0\)</span> and <span class="math inline">\(\pi' H(1)=0\)</span>. Reciprocally, if <span class="math inline">\(\pi' \mu = 0\)</span> and <span class="math inline">\(\pi' H(1)=0\)</span>, then <span class="math inline">\(\pi\)</span> is a cointegrating vector of <span class="math inline">\(y_t\)</span>. This proves the following proposition:</p>
<div class="proposition">
<p><span id="prp:NScondCoint" class="proposition"><strong>Proposition 6.2  (Necessary and sufficient conditions of cointegration) </strong></span>If <span class="math inline">\(y_t\)</span> is <span class="math inline">\(I(1)\)</span> and admits the Wold representation Eq. <a href="cointeg.html#eq:I1">(6.3)</a>, with <span class="math inline">\(d=1\)</span>, then <span class="math inline">\(\pi\)</span> is a cointegrating vector iff
<span class="math display">\[
\pi' \mu = 0 \mbox{ (scalar equation) and }\pi' H(1)=0\mbox{ (vectorial equation)}.
\]</span></p>
</div>
<p>Consider the following VAR(p) model, where <span class="math inline">\(y_t\)</span> is <span class="math inline">\(I(1)\)</span>:
<span class="math display" id="eq:yVECM1">\[\begin{equation}
y_t = c + \Phi_1 y_{t-1} + \dots + \Phi_p y_{t-p} + \varepsilon_t,\tag{6.4}
\end{equation}\]</span>
or <span class="math inline">\(\Phi(L)y_t = c + \varepsilon_t\)</span> where <span class="math inline">\(\Phi(L) = I - \Phi_1 L - \dots - \Phi_p L^p\)</span>.</p>
<p>Suppose that the Wold representation of <span class="math inline">\(\Delta y_t\)</span> is Eq. <a href="cointeg.html#eq:I1">(6.3)</a>. Premultiplying Eq. <a href="cointeg.html#eq:I1">(6.3)</a> by <span class="math inline">\(\Phi(L)\)</span> gives:
<span class="math display">\[
(1-L)\Phi(L)y_t = \Phi(1)\mu + \Phi(L)H(L)\varepsilon_t,
\]</span>
or
<span class="math display">\[
(1-L)\varepsilon_t = \Phi(1)\mu + \Phi(L)H(L)\varepsilon_t.
\]</span>
Taking the expectation on both sides gives <span class="math inline">\(\Phi(1)\mu=0\)</span>. Therefore, for the previous equation to hold for any <span class="math inline">\(\varepsilon_t\)</span>, we must have
<span class="math display">\[
(1-L) Id = \Phi(L)H(L).
\]</span>
The previous equality implies that <span class="math inline">\((1-z) Id = \Phi(z)H(z)\)</span> for all <span class="math inline">\(z\)</span>. In particular, for <span class="math inline">\(z=1\)</span>:
<span class="math display">\[
0 = \Phi(1)H(1).
\]</span></p>
<p>Take any row <span class="math inline">\(\pi'\)</span> of <span class="math inline">\(\Phi(1)\)</span>. Since <span class="math inline">\(\Phi(1)\mu=0\)</span>, we have <span class="math inline">\(\pi'\mu=0\)</span> (scalar equation). Since <span class="math inline">\(\Phi(1)H(1)=0\)</span>, we have <span class="math inline">\(\pi' H(1)=0\)</span> (vectorial equation). Prop. <a href="cointeg.html#prp:NScondCoint">6.2</a> then implies that the rows of <span class="math inline">\(\Phi(1)\)</span> are cointegrating vectors of <span class="math inline">\(y_t\)</span>. Therefore, if <span class="math inline">\(\{a_1,\dots,a_h\}\)</span> constitutes a basis for the space of cointegrating vectors, then <span class="math inline">\(\pi\)</span> can be expressed as a linear combination of the <span class="math inline">\(a_i\)</span>’s. That is, we must have:
<span class="math display">\[
\pi = [a_1 \quad a_2 \quad \dots \quad a_h]b = \underbrace{A}_{n\times h}\underbrace{b}_{h \times 1},
\]</span>
where <span class="math inline">\(A = [a_1 \quad a_2 \quad \dots \quad a_h]\)</span>.</p>
<p>Since this is true for all rows of <span class="math inline">\(\Phi(1)\)</span>, it comes that this matrix is of the form:
<span class="math display" id="eq:BAvecm">\[\begin{equation}
\underbrace{\Phi(1)}_{n\times n} = \underbrace{B}_{n\times h}\underbrace{A'}_{h\times n}.\tag{6.5}
\end{equation}\]</span>
This shows that the number of independent cointegrating vectors—he order of cointegration of <span class="math inline">\(y_t\)</span>—is the rank of <span class="math inline">\(\Phi(1)\)</span>. This has important implications for the dynamics of <span class="math inline">\(\Delta y_t\)</span>.</p>
<p>Consider a process <span class="math inline">\(y_t\)</span> whose VAR representation is as in Eq. <a href="cointeg.html#eq:yVECM1">(6.4)</a>. This VAR representation can be rewritten:
<span class="math display" id="eq:yVECM2">\[\begin{equation}
y_t = (c + \rho y_{t-1}) + \zeta_1 \Delta y_{t-1} + \dots + \zeta_{p-1} \Delta y_{t-p+1} + \varepsilon_t,\tag{6.6}
\end{equation}\]</span>
where <span class="math inline">\(\zeta_k = - \Phi_{k+1} - \dots - \Phi_{p}\)</span> and <span class="math inline">\(\rho = \Phi_1 + \dots + \Phi_p\)</span>.</p>
<div class="example">
<p><span id="exm:vecmVAR2" class="example"><strong>Example 6.1  (VAR(2)) </strong></span>For a VAR(2) with <span class="math inline">\(y_t = c + \Phi_1 y_{t-1}+ \Phi_2 y_{t-2} + \varepsilon_t\)</span>, we have:
<span class="math display">\[
y_t = c + \{\Phi_1 + \Phi_2\} y_{t-1} + \{-\Phi_2\} \Delta y_{t-1} + \varepsilon_t,
\]</span></p>
</div>
<p>Subtracting <span class="math inline">\(y_{t-1}\)</span> from both sides of Eq. <a href="cointeg.html#eq:yVECM2">(6.6)</a> and remarking that <span class="math inline">\(-\Phi(1) = \rho - Id\)</span> (recall that <span class="math inline">\(\Phi(L) = I - \Phi_1 L - \dots - \Phi_p L^p\)</span>), we get:
<span class="math display">\[
\Delta y_t = \{c - \underbrace{\Phi(1) y_{t-1}}_{=BA'y_{t-1}}\} + \zeta_1 \Delta y_{t-1} + \dots + \zeta_{p-1} \Delta y_{t-p+1} + \varepsilon_t.
\]</span></p>
<p>Using Eq. <a href="cointeg.html#eq:BAvecm">(6.5)</a>, and denoting by <span class="math inline">\(z_t\)</span> the <span class="math inline">\(h\)</span>-dimensional vector <span class="math inline">\(A'y_{t}\)</span>, we obtain the <strong>error correction representation</strong> of the cointegrated variable <span class="math inline">\(y_t\)</span>:
<span class="math display" id="eq:VECM3">\[\begin{equation}
\boxed{\Delta y_t = c - B z_{t-1} + \zeta_1 \Delta y_{t-1} + \dots + \zeta_{p-1} \Delta y_{t-p+1} + \varepsilon_t.}\tag{6.7}
\end{equation}\]</span>
This type of model is called <strong>Vector Error Correction Model</strong> (VECM). This is because the components of <span class="math inline">\(z_t\)</span> can be considered as errors that, multiplied by the components of <span class="math inline">\(B\)</span> generate correction forces that imply that, in the long run, the congregation relationships are satisfied. Example <a href="cointeg.html#exm:ExampleVECM1">6.2</a> illustrates this.</p>
<!-- The $k^{th}$ line of Eq. \@ref(eq:VECM3) is: -->
<!-- \begin{eqnarray*} -->
<!-- \Delta y_{k,t} &=& c_k - \sum_{j=1}^{h}b_{k,j} \underbrace{\sum_{i=1}^{n} a_{i,j}y_{i,t-1}}_{=z_{j,t-1}} + \\ -->
<!-- && (\zeta_1)_{k,1} \Delta y_{1,t-1} + \dots + (\zeta_1)_{k,n} \Delta y_{n,t-1} +\\ -->
<!-- && \qquad \vdots\\ -->
<!-- && (\zeta_{p-1})_{k,1} \Delta y_{1,t-p+1} + \dots + (\zeta_{p-1})_{k,n} \Delta y_{n,t-p+1} +\\ -->
<!-- && \varepsilon_{k,t}, -->
<!-- \end{eqnarray*} -->
<!-- where $(\zeta_{i})_{k,j}$ denotes the element $(k,j)$ of matrix $\zeta_{i}$. -->
<div class="example">
<p><span id="exm:ExampleVECM1" class="example"><strong>Example 6.2  (VECM example) </strong></span>Consider the VAR(1) process <span class="math inline">\(y_t\)</span> that follows:
<span class="math display">\[
y_t = \Phi_1 y_{t-1} + \varepsilon_t = \left[\begin{array}{cc}
0.5 &amp; 0.5 \\
0.2 &amp; 0.8 \\
\end{array}
\right] y_{t-1} + \varepsilon_t, \quad \varepsilon_t \sim i.i.d. \mathcal{N}(0,\Sigma)
\]</span></p>
<p>1 is an eigenvalue of <span class="math inline">\(\Phi_1\)</span> and <span class="math inline">\(y_t\)</span> is <span class="math inline">\(I(1)\)</span>. We have:
<span class="math display">\[
\Phi(1) = Id - \left[\begin{array}{cc}
0.5 &amp; 0.5 \\
0.2 &amp; 0.8 \\
\end{array}
\right] = \left[\begin{array}{cc}
0.5 &amp; -0.5 \\
-0.2 &amp; 0.2 \\
\end{array}
\right],
\]</span>
which is of rank 1. Therefore <span class="math inline">\(y_t\)</span> is cointegrated of order 1.</p>
<p>For that process, Eq. <a href="cointeg.html#eq:VECM3">(6.7)</a> writes:
<span class="math display">\[
\Delta y_{t} =
- \left[\begin{array}{cc}
0.5 &amp; -0.5 \\
-0.2 &amp; 0.2
\end{array}
\right] y_{t-1} + \varepsilon_t =
\left[\begin{array}{c}
-0.5\\
0.2
\end{array}
\right] z_{t-1} + \varepsilon_t,
\]</span>
where <span class="math inline">\(z_{t} = y_{1,t}-y_{2,t}\)</span>.</p>
<p>The process <span class="math inline">\(z_t\)</span> is stationary (we have <span class="math inline">\(z_t = 0.3 z_{t-1} + \varepsilon_{1,t} - \varepsilon_{2,t}\)</span>).</p>
<p>We say that there is a <em>long-run relationship</em> between <span class="math inline">\(y_{1,t}\)</span> and <span class="math inline">\(y_{2,t}\)</span>:</p>
<p>When <span class="math inline">\(y_{1,t}\)</span> is substantially above <span class="math inline">\(y_{2,t}\)</span>, <span class="math inline">\(z_t\)</span> is large, the influence of <span class="math inline">\(-0.5 z_t\)</span> on <span class="math inline">\(\Delta y_{1,t+1}\)</span> is negative, which tends to “correct” <span class="math inline">\(y_{1,t}\)</span> and brings it closer to <span class="math inline">\(y_{2,t}\)</span>.</p>
<div class="figure" style="text-align: left-aligned">
<span style="display:block;" id="fig:VECMexmpl"></span>
<img src="TimeSeries_files/figure-html/VECMexmpl-1.png" alt="Simulation of $y_{1,t}$ (in blue) and $y_{2,t}$ (in red)." width="95%"><p class="caption">
Figure 6.2: Simulation of <span class="math inline">\(y_{1,t}\)</span> (in blue) and <span class="math inline">\(y_{2,t}\)</span> (in red).
</p>
</div>
</div>
<div id="cointegration-in-practice" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Cointegration in practice<a class="anchor" aria-label="anchor" href="#cointegration-in-practice"><i class="fas fa-link"></i></a>
</h3>
<p>Assume that we have a vector of variables <span class="math inline">\(y_t\)</span> and that we want to investigate the joint dynamics of its components. If the <span class="math inline">\(y_{i,t}\)</span>s are <span class="math inline">\(I(1)\)</span>, we may need to use a VECM. Therefore, in the first place, one has to test for the stationarity of <span class="math inline">\(y_t\)</span>’s components (see Section <a href="NonStat.html#NonStat">5</a>).</p>
<p>If the components of <span class="math inline">\(y_t\)</span> are <span class="math inline">\(I(1)\)</span>, one has to determine the existence of cointegrating vectors. There are two general possibilities to do this:</p>
<ol style="list-style-type: decimal">
<li>The theory provides us with relevant cointegration relationships, for instance:
<ul>
<li>The Purchasing Power Parity (PPP) suggests the existence of a long-run relationship between domestic prices, foreign prices, and the exchange rate.</li>
<li>If real rates are stationary, the Fisher equation (<span class="math inline">\(r=i-\pi\)</span>) implies a cointegration relatinsip between the nominal interest rate (<span class="math inline">\(i\)</span>) and inflation <span class="math inline">\(\pi\)</span>.</li>
</ul>
</li>
<li>We have no a priori regarding the cointegration relationship. We have to estimate (and test) the potential cointegration relationship.</li>
</ol>
<p>In the first case, we proceed in two steps:
a. If <span class="math inline">\(\pi^*\)</span> is suspected to be a cointegrating vector, we can then use unit-root or stationarity tests on <span class="math inline">\(z_t={\pi^*}' y_t\)</span> (see Section @ref{NonStat}).
b. Estimate Eq. <a href="cointeg.html#eq:VECM3">(6.7)</a> by OLS.</p>
<p>In the following, we focus on the second case, when there is at most one cointegration relationship. (In the general case, one can for instance implement the <span class="citation">Johansen (<a href="references.html#ref-Johansen_1991" role="doc-biblioref">1991</a>)</span> approach.)</p>
<p><span class="citation">Engle and Granger (<a href="references.html#ref-Engle_Granger_1987" role="doc-biblioref">1987</a>)</span> propose a two-step estimation procedure to estimate error-correction models. This method proceeds under the assumption that there is a single cointegration equation, i.e. <span class="math inline">\(A' = [\alpha_1,\dots,\alpha_n]\)</span>. (Recall that <span class="math inline">\(\Phi(1) = BA'\)</span>, see Eq. <a href="cointeg.html#eq:BAvecm">(6.5)</a>.) Without loss of generality, one can set <span class="math inline">\(\alpha_1=1\)</span>. In that case, the cointegration relationship, if it exists, is of the form:
<span class="math display">\[
y_{1,t} = - \alpha_2 y_{2,t} - \dots - \alpha_n y_{n,t} + z_t,
\]</span>
where <span class="math inline">\(z_t \sim I(0)\)</span>.</p>
<p>The first step consists in estimating the previous equation by OLS (regression of <span class="math inline">\(y_{1,t}\)</span> on <span class="math inline">\(y_{2,t},\dots,y_{2,t}\)</span>). The second step consists in estimating Eq. <a href="cointeg.html#eq:VECM3">(6.7)</a> also by OLS, after having replaced <span class="math inline">\(z_{t-1}\)</span> by the (lagged) residuals of the first step OLS regression (<span class="math inline">\(\hat{z}_{t-1}\)</span>). Because of high speed convergence of the first-step regression (the convergence is in <span class="math inline">\(1/T\)</span>, see Eq. <a href="cointeg.html#eq:bTsuperconv">(6.2)</a>), the asymptotic properties of the second-step estimates are the standard ones. That is, one can use the standard t-statistic to assess the statistical significativity of the parameters.</p>
<p>It remains to explain how to test for the existence of a cointegration relationship. This amounts to testing whether <span class="math inline">\(z_t\)</span> is stationary. Note however that we do not observe the “true” <span class="math inline">\(z_t\)</span>, but only OLS-based estimates <span class="math inline">\(\hat{z}_t\)</span>. Therefore, the critical values of the usual unit-root tests are not the same. The appropriate critical values are given by <span class="citation">P. C. B. Phillips and Ouliaris (<a href="references.html#ref-Phillips_Ouliaris_1990" role="doc-biblioref">1990</a>)</span>.</p>
<div class="example">
<p><span id="exm:VECMUS" class="example"><strong>Example 6.3  (VECM for US inflation and nominal interest rate) </strong></span>The data are as in Example <a href="NonStat.html#exm:NonStatExample">5.1</a>. In the first step, we compute <span class="math inline">\(z_t\)</span> and use <span class="citation">P. C. B. Phillips and Ouliaris (<a href="references.html#ref-Phillips_Ouliaris_1990" role="doc-biblioref">1990</a>)</span>’s test to see whether the two variables are cointegrated:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AEC</span><span class="op">)</span>;<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">US3var</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">infl</span> <span class="op">&lt;-</span> <span class="va">US3var</span><span class="op">$</span><span class="va">infl</span></span>
<span><span class="va">i</span>    <span class="op">&lt;-</span> <span class="va">US3var</span><span class="op">$</span><span class="va">r</span></span>
<span><span class="va">eq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">i</span><span class="op">~</span><span class="va">infl</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">eq</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/po.test.html">po.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">infl</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Phillips-Ouliaris Cointegration Test
## 
## data:  cbind(i, infl)
## Phillips-Ouliaris demeaned = -29.484, Truncation lag parameter = 2,
## p-value = 0.01</code></pre>
<p>We reject the null hypothesis of unit root in the residuals. That is, the results are in favor of cointegration. Let us then esitmate the VECM model; this amounts to running two OLS regressions:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infl_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NaN</span>,<span class="va">infl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">infl_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NaN</span>,<span class="cn">NaN</span>,<span class="va">infl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">infl_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NaN</span>,<span class="cn">NaN</span>,<span class="cn">NaN</span>,<span class="va">infl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">i_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NaN</span>,<span class="va">i</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">i_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NaN</span>,<span class="cn">NaN</span>,<span class="va">i</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">i_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NaN</span>,<span class="cn">NaN</span>,<span class="cn">NaN</span>,<span class="va">i</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">z_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NaN</span>,<span class="va">z</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dinfl</span>   <span class="op">&lt;-</span> <span class="va">infl</span>   <span class="op">-</span> <span class="va">infl_1</span></span>
<span><span class="va">dinfl_1</span> <span class="op">&lt;-</span> <span class="va">infl_1</span> <span class="op">-</span> <span class="va">infl_2</span></span>
<span><span class="va">dinfl_2</span> <span class="op">&lt;-</span> <span class="va">infl_2</span> <span class="op">-</span> <span class="va">infl_3</span></span>
<span><span class="va">di</span>   <span class="op">&lt;-</span> <span class="va">i</span>   <span class="op">-</span> <span class="va">i_1</span></span>
<span><span class="va">di_1</span> <span class="op">&lt;-</span> <span class="va">i_1</span> <span class="op">-</span> <span class="va">i_2</span></span>
<span><span class="va">di_2</span> <span class="op">&lt;-</span> <span class="va">i_2</span> <span class="op">-</span> <span class="va">i_3</span></span>
<span><span class="va">eq1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">di</span>    <span class="op">~</span> <span class="va">z_1</span> <span class="op">+</span> <span class="va">dinfl_1</span> <span class="op">+</span> <span class="va">di_1</span> <span class="op">+</span> <span class="va">dinfl_2</span> <span class="op">+</span> <span class="va">di_2</span><span class="op">)</span></span>
<span><span class="va">eq2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">dinfl</span> <span class="op">~</span> <span class="va">z_1</span> <span class="op">+</span> <span class="va">dinfl_1</span> <span class="op">+</span> <span class="va">di_1</span> <span class="op">+</span> <span class="va">dinfl_2</span> <span class="op">+</span> <span class="va">di_2</span><span class="op">)</span></span></code></pre></div>
<p>Table <a href="cointeg.html#tab:EngleGrangerUS3">6.1</a> reports the estimated coefficients in <code>eq1</code> and <code>eq2</code>, together with their p-values:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:EngleGrangerUS3">Table 6.1: </span>Results of the second-stage OLS regressions (Engle-Granger approach). The first variable is the short-term nominal interest rate; the second variable is inflation.</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Coef Y1</th>
<th align="right">p-values Y1</th>
<th align="right">Coef Y2</th>
<th align="right">p-values Y2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.0189</td>
<td align="right">0.8093</td>
<td align="right">-0.0047</td>
<td align="right">0.9457</td>
</tr>
<tr class="even">
<td align="left">z_1</td>
<td align="right">-0.1040</td>
<td align="right">0.0014</td>
<td align="right">-0.0034</td>
<td align="right">0.9046</td>
</tr>
<tr class="odd">
<td align="left">dinfl_1</td>
<td align="right">0.0224</td>
<td align="right">0.7852</td>
<td align="right">-0.3845</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">di_1</td>
<td align="right">-0.0841</td>
<td align="right">0.2225</td>
<td align="right">0.1196</td>
<td align="right">0.0473</td>
</tr>
<tr class="odd">
<td align="left">dinfl_2</td>
<td align="right">0.0322</td>
<td align="right">0.6864</td>
<td align="right">-0.2238</td>
<td align="right">0.0014</td>
</tr>
<tr class="even">
<td align="left">di_2</td>
<td align="right">-0.0393</td>
<td align="right">0.5625</td>
<td align="right">0.0828</td>
<td align="right">0.1626</td>
</tr>
</tbody>
</table></div>
<p>Imporantly, one of the parameters associated with <span class="math inline">\(z_{t-1}\)</span> (parameters that are called speeds of adjustement) is significant and with the expected signs: if the short term nominal interest rate <span class="math inline">\(i_t\)</span> is high then <span class="math inline">\(z_t\)</span> becomes positive (since, up to an intercept, <span class="math inline">\(z_t = i_t - \beta \pi_t\)</span>, where <span class="math inline">\(\beta\)</span> comes from the first-step regression), but since <span class="math inline">\(B_{1,1}\)</span> is negative (it is equal to -0.104), a positive <span class="math inline">\(z_t\)</span> will generate a negative correction (i.e., <span class="math inline">\(B_{1,1}z_t\)</span>) for <span class="math inline">\(i_{t+1}\)</span> on date <span class="math inline">\(t+1\)</span>, thereby “correcting” the high level of <span class="math inline">\(i_t\)</span>.</p>
</div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="NonStat.html"><span class="header-section-number">5</span> Non-stationary processes</a></div>
<div class="next"><a href="ARCHGARCH.html"><span class="header-section-number">7</span> ARCH and GARCH models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cointeg"><span class="header-section-number">6</span> Introduction to cointegration</a></li>
<li><a class="nav-link" href="#intuition"><span class="header-section-number">6.1</span> Intuition</a></li>
<li><a class="nav-link" href="#the-bivariate-case"><span class="header-section-number">6.2</span> The bivariate case</a></li>
<li>
<a class="nav-link" href="#multivariate-case-and-vecm"><span class="header-section-number">6.3</span> Multivariate case and VECM</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#cointegration-in-practice"><span class="header-section-number">6.3.1</span> Cointegration in practice</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Time Series</strong>" was written by Jean-Paul Renne. It was last built on 2023-03-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
